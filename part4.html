<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Listening Practice ‚Äì Part 1 (Section 3)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    * {
      box-sizing: border-box;
    }
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      font-family: Arial, sans-serif;
      color: #111;
    }
    body {
      position: relative;
      padding-top: 120px;
      background: #f5f5f5;
    }
    .bg-blur {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image: url('d803c829-d5f1-4002-87f7-348979de61b6.png');
      background-size: cover;
      background-position: center;
      z-index: -2;
    }
    .bg-blur::after {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(255, 255, 255, 0.5);
      z-index: 1;
    }
    .glass {
      background: rgba(255, 255, 255, 0.7);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border: 1px solid rgba(0, 0, 0, 0.1);
      border-radius: 10px;
    }

    .header {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      padding: 10px 20px;
      background: rgba(255, 255, 255, 0.85);
      z-index: 1000;
      display: flex;
      flex-direction: row;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1px solid #ccc;
    }
    .header h2 {
      margin: 0;
      font-size: 20px;
      color: #222;
    }
    #music {
      width: 240px;
    }

    .section {
      max-width: 900px;
      margin: 140px auto 60px;
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .instruction {
      background: rgba(255, 255, 255, 0.6);
      padding: 15px 20px;
      border-radius: 8px;
      border: 1px solid #ddd;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      background: white;
      border-radius: 8px;
      overflow: hidden;
    }
    th, td {
      padding: 12px;
      border: 1px solid #ccc;
      text-align: left;
      vertical-align: top;
      font-size: 16px;
    }
    td input[type="radio"] {
      margin-right: 5px;
    }

    .nav-row {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      margin-top: 20px;
    }

    button {
      padding: 12px 24px;
      font-size: 16px;
      border-radius: 8px;
      border: 1px solid #555;
      background: rgba(0, 0, 0, 0.05);
      color: #222;
      cursor: pointer;
      transition: background 0.3s;
    }
    button:hover {
      background: rgba(0, 0, 0, 0.15);
    }

    .result {
      margin-top: 25px;
      font-size: 20px;
      font-weight: bold;
      text-align: center;
      color: #000;
    }
    .feedback {
      margin-left: 10px;
      font-size: 16px;
      font-weight: bold;
    }

    #downloadPdfBtn {
      display: none;
      font-size: 22px;
      margin-top: 15px;
      text-align: center;
      cursor: pointer;
      color: #222;
      user-select: none;
    }

    @media (max-width: 768px) {
      .header {
        flex-direction: column;
        align-items: flex-start;
      }
      #music {
        width: 100%;
        margin-top: 10px;
      }
      th, td {
        font-size: 14px;
      }
    }
  </style>
</head>
<body>
  <div class="bg-blur"></div>
  <div class="header">
    <h2>Listening Practice</h2>
<audio id="audio" src="Listening Practice 8.mp3" preload="auto" controls></audio>
<div class="button-group">
  <button onclick="playClip(1155)">‚ñ∂Ô∏è Play Section 4 (19:15)</button>
</div>
    <h2 style="color: rgb(170, 3, 3);">EDU</h2>
  </div>

<div class="section glass">
  <h2>Section 4: Questions 31‚Äì40</h2>
  <p><strong>Choose the best option A, B or C.</strong></p>

  <div class="instruction" id="space-exploitation">
    <h3 id="space-heading">Notes: Space Exploitation</h3>

    <p id="space-intro-title"><strong>Introduction:</strong></p>
    <ul id="space-intro-list">
      <li>Space agencies and others use mythologies to create a sense of <input type="text" id="q31" placeholder="31">.</li>
      <li>There are great <input type="text" id="q32" placeholder="32"> to be harvested from exploiting space.</li>
      <li>Nations that control the <input type="text" id="q33" placeholder="33"> on the Moon or Mars will earn vast profits.</li>
      <li>Earth exploration-growth in technology and <input type="text" id="q34" placeholder="34"> only the beginning.</li>
    </ul>

    <p id="moon-section-title"><strong>The Moon:</strong></p>
    <ul id="moon-section-list">
      <li>Helium3 - if we <input type="text" id="q35" placeholder="35"> its possibilities, we will lose control of the economy.</li>
      <li>Commercial activity should support the first Moon <input type="text" id="q36" placeholder="36">.</li>
      <li>The surface has already been <input type="text" id="q37" placeholder="37">.</li>
      <li>Wealth-sharing: Problems without <input type="text" id="q38" placeholder="38"> controls and agreements.</li>
    </ul>

    <p id="nuclear-title"><strong>Nuclear power:</strong></p>
    <ul id="nuclear-list">
      <li>Use in space may cause <input type="text" id="q39" placeholder="39"> problems for humans.</li>
      <li><strong>Space junk:</strong> So serious that the possibility of space tourism is in <input type="text" id="q40" placeholder="40">.</li>
    </ul>
  </div>
</div>


<div id="resetStatsBtn" style="display: none;">
  <button onclick="resetStats()">üßπ Reset Section 3 Stats</button>
</div>

    <div class="nav-row">
      <a href="part3.html"><button>‚¨ÖÔ∏è Previous Part</button></a>
      <button onclick="checkAnswers()">‚úÖ Submit</button>
      <div id="downloadPdfBtn" onclick="downloadPDF()">üìÑ Download PDF</div>
    </div>

    <div class="result" id="resultBox"></div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
    let stopTimer = null;

  function playClip(startTime, duration) {
    const audio = document.getElementById("audio");

    // Stop previous timer
    if (stopTimer) clearTimeout(stopTimer);

    // Jump to start and play
    audio.currentTime = startTime;
    audio.play();

    // Stop after duration (in seconds)
    stopTimer = setTimeout(() => {
      audio.pause();
    }, duration * 1000);
  }
  const correctAnswers = {
    q31: "excitement",
    q32: "benefits",
    q33: "territory",
    q34: "civilization",
    q35: "ignore",
    q36: "base",
    q37: "mapped",
    q38: "legal",
    q39: "health",
    q40: "doubt"
  };

function showFeedback(key, userInput, correctAnswer) {
  const inputEl = document.getElementById(key);
  const oldFeedback = document.getElementById(`${key}-feedback`);
  if (oldFeedback) oldFeedback.remove();

  const feedback = document.createElement("span");
  feedback.className = "feedback";
  feedback.id = `${key}-feedback`;

  if (userInput.trim().toLowerCase() === correctAnswer.toLowerCase()) {
    feedback.textContent = "‚úÖ Correct";
    feedback.style.color = "green";
    return { feedback, isCorrect: true };
  } else {
    feedback.textContent = `‚ùå Wrong ‚Äî Correct: ${correctAnswer}`;
    feedback.style.color = "red";
    return { feedback, isCorrect: false };
  }
}

function checkAnswers() {
  const submittedBefore = localStorage.getItem("p4_submitted");
  if (submittedBefore) {
    let attempts = +localStorage.getItem("p4_cheat") || 0;
    localStorage.setItem("p4_cheat", ++attempts);
    let shame = document.getElementById("cheat-warning");
    if (!shame) {
      shame = document.createElement("div");
      shame.id = "cheat-warning";
      shame.style.color = "red";
      shame.style.fontSize = "18px";
      shame.style.fontWeight = "bold";
      shame.style.textAlign = "center";
      shame.style.marginTop = "15px";
      document.getElementById("resultBox").after(shame);
    }
    shame.innerHTML = `üõë Stop cheating! You've tried ${attempts} times after submission! üò°`;
    return;
  }

  let correct = 0;
  const total = Object.keys(correctAnswers).length;

  for (let key in correctAnswers) {
    let userInput = "";

    const radios = document.getElementsByName(key);
    for (const radio of radios) {
      if (radio.checked) {
        userInput = radio.value;
        break;
      }
    }

    const correctAnswer = correctAnswers[key];
    localStorage.setItem("p4_" + key, userInput);

    if (userInput.toLowerCase() === correctAnswer.toLowerCase()) {
      correct++;
    }
  }

  const incorrect = total - correct;
  const resultText = `‚úÖ Correct: ${correct} üòä<br>‚ùå Wrong: ${incorrect} üò¢`;
  document.getElementById("resultBox").innerHTML = resultText;
  localStorage.setItem("p4_result", resultText);
  localStorage.setItem("p4_submitted", "true");

  document.getElementById("downloadPdfBtn").style.display = "block";
}

window.onload = () => {
  for (let key in correctAnswers) {
    const saved = localStorage.getItem("p4_" + key);
    if (saved) {
      const radios = document.getElementsByName(key);
      for (const radio of radios) {
        if (radio.value.toLowerCase() === saved.toLowerCase()) {
          radio.checked = true;
          break;
        }
      }
    }
  }

  const savedResult = localStorage.getItem("p4_result");
  if (savedResult) document.getElementById("resultBox").innerHTML = savedResult;

  if (localStorage.getItem("p4_submitted") === "true")
    document.getElementById("downloadPdfBtn").style.display = "block";

  const cheatCount = +localStorage.getItem("p4_cheat") || 0;
  if (cheatCount > 0) {
    const shame = document.createElement("div");
    shame.id = "cheat-warning";
    shame.style.color = "red";
    shame.style.fontSize = "18px";
    shame.style.fontWeight = "bold";
    shame.style.textAlign = "center";
    shame.style.marginTop = "15px";
    shame.innerHTML = `üõë You already submitted and tried to cheat ${cheatCount} time(s)!`;
    document.getElementById("resultBox").after(shame);
  }
};

function downloadPDF() {
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();
  doc.setFontSize(12);
  doc.text("Listening Practice ‚Äì(Section 4)", 10, 10);

  let y = 20;
  Object.entries(correctAnswers).forEach(([key, answer], i) => {
    const input = localStorage.getItem("p4_" + key) || "(empty)";
    doc.text(`${i + 21}. Your Answer: ${input} | Correct Answer: ${answer}`, 10, y);
    y += 10;
  });

  const result = localStorage.getItem("p4_result") || "";
  doc.text("Result:", 10, y + 10);
  doc.text(result.replace(/<br>/g, " "), 10, y + 20);
  doc.save("Section4_Answers.pdf");
}
function resetStats() {
  const password = prompt("Enter reset password:");

  if (password !== "listen123") {
    alert("‚ùå Incorrect password. Stats were not cleared.");
    return;
  }

  const keysToRemove = [];

  for (let i = 0; i < localStorage.length; i++) {
    const key = localStorage.key(i);
    if (key && key.startsWith("p4_")) {
      keysToRemove.push(key);
    }
  }

  if (keysToRemove.length === 0) {
    alert("‚ö†Ô∏è No Section 3 stats found to clear.");
    return;
  }

  keysToRemove.forEach(key => localStorage.removeItem(key));

  alert(`‚úÖ Section 3 stats cleared! (${keysToRemove.length} items)`);
  location.reload();
}

// ‚úÖ This must be outside the function
document.addEventListener("keydown", function (e) {
  if (e.ctrlKey && e.key.toLowerCase() === "i") {
    e.preventDefault(); // Optional: prevent browser default action for Ctrl+I (italic in some browsers)
    const btn = document.getElementById("resetStatsBtn");
    if (btn) {
      btn.style.display = "block";
      btn.scrollIntoView({ behavior: "smooth" });
    }
  }
});

</script>
</body>
</html>
