<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Listening Practice ‚Äì Part 1 (Section 2)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="Icon" type="img/jpeg" href="4a707f53-e034-4bd0-b77f-37654f3b0543.png" class="icon1">
  <style>
    * { box-sizing: border-box; }
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      font-family: Arial, sans-serif;
      color: #111;
    }
    body {
      position: relative;
      padding-top: 120px;
      background: #f5f5f5;
    }
    .bg-blur {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image: url('d803c829-d5f1-4002-87f7-348979de61b6.png');
      background-size: cover;
      background-position: center;
      z-index: -2;
    }
    .bg-blur::after {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(255, 255, 255, 0.5);
      z-index: 1;
    }
    .glass {
      background: rgba(255, 255, 255, 0.7);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border: 1px solid rgba(0, 0, 0, 0.1);
      border-radius: 10px;
    }
    .header {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      padding: 10px 20px;
      background: rgba(255, 255, 255, 0.85);
      z-index: 1000;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1px solid #ccc;
    }
    .header h2 {
      margin: 0;
      font-size: 20px;
      color: #222;
    }
    #music {
      padding-top: 10px;
      width: 240px;
    }
    .section {
      max-width: 800px;
      margin: auto;
      padding: 20px;
    }
    .instruction {
      background: rgba(255, 255, 255, 0.6);
      padding: 15px 20px;
      margin-bottom: 20px;
      border-radius: 8px;
      border: 1px solid #ddd;
    }
    ol {
      padding-left: 20px;
      font-size: 18px;
    }
    ol li {
      margin: 15px 0;
    }
    input[type="text"] {
      padding: 8px;
      margin-left: 6px;
      border: 1px solid #aaa;
      border-radius: 5px;
      font-size: 16px;
      background: rgba(255, 255, 255, 0.9);
      color: #000;
      width: 150px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    th, td {
      padding: 10px;
      border: 1px solid #ccc;
      text-align: center;
    }
    .nav-row {
      margin-top: 30px;
      text-align: center;
    }
    button {
      padding: 12px 24px;
      font-size: 16px;
      border-radius: 8px;
      border: 1px solid #555;
      background: rgba(0, 0, 0, 0.05);
      color: #222;
      cursor: pointer;
      transition: background 0.3s;
      margin: 10px;
    }
    button:hover {
      background: rgba(0, 0, 0, 0.15);
    }
    .result {
      margin-top: 25px;
      font-size: 20px;
      font-weight: bold;
      text-align: center;
      color: #000;
    }
    .feedback {
      margin-left: 10px;
      font-size: 16px;
      font-weight: bold;
    }
    #downloadPdfBtn {
      display: none;
      font-size: 22px;
      margin-top: 15px;
      text-align: center;
      cursor: pointer;
      color: #222;
      user-select: none;
    }
    @media (max-width: 768px) {
      input[type="text"] {
        width: 100%;
        margin: 10px 0 0 0;
      }
      ol {
        font-size: 16px;
      }
      table, th, td {
        font-size: 14px;
      }
      audio {
        width: 100%;
      }
      .header {
        flex-direction: column;
        align-items: flex-start;
      }
    }
  </style>
</head>
<body>
  <div class="bg-blur"></div>
  <div class="header">
    <h2>Listening Practice</h2>
<audio id="audio" src="Listening Practice 8.mp3" preload="auto" controls></audio>
<div class="button-group">
  <button onclick="playClip(600)">‚ñ∂Ô∏è Play Section 2 (10:00-13:14)</button>
</div>
  <h2 style="color: rgb(170, 3, 3);">EDU</h2>
  </div>

  <div class="section glass">
    <h2>Section 2: Questions 11‚Äì20</h2>
    <p><strong>Complete the sentences below. Write NO MORE THAN TWO WORDS for each answer.</strong></p>

    <ol start="11">
      <li>The Shelter Society started in The Cedars <input type="text" id="q11" />.</li>
      <li>Many volunteers help with the Society‚Äôs fund-raising and <input type="text" id="q12" /> activities.</li>
      <li>There has been a fifty percent increase in homelessness in the last  <input type="text" id="q13" />.</li>
      <li>Homelessness has been made worse by  <input type="text" id="q14" /> in government assistance.</li>
      <li>Our <input type="text" id="q15" /> and former neighbors really need our help.</li>
    </ol>

    <hr />

    <p><strong>Choose the correct letter, A, B, or C.</strong></p>
    <table>
      <thead>
        <tr>
          <th>Question</th>
          <th>A Maria Sunderland</th>
          <th>B Letica Perez</th>
          <th>C Roman Aranov</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>16</td>
          <td><input type="radio" name="q16" id="q16a" value="A" /></td>
          <td><input type="radio" name="q16" id="q16b" value="B" /></td>
          <td><input type="radio" name="q16" id="q16c" value="C" /></td>
        </tr>
        <tr>
          <td>17</td>
          <td><input type="radio" name="q17" id="q17a" value="A" /></td>
          <td><input type="radio" name="q17" id="q17b" value="B" /></td>
          <td><input type="radio" name="q17" id="q17c" value="C" /></td>
        </tr>
        <tr>
          <td>18</td>
          <td><input type="radio" name="q18" id="q18a" value="A" /></td>
          <td><input type="radio" name="q18" id="q18b" value="B" /></td>
          <td><input type="radio" name="q18" id="q18c" value="C" /></td>
        </tr>
        <tr>
          <td>19</td>
          <td><input type="radio" name="q19" id="q19a" value="A" /></td>
          <td><input type="radio" name="q19" id="q19b" value="B" /></td>
          <td><input type="radio" name="q19" id="q19c" value="C" /></td>
        </tr>
        <tr>
          <td>20</td>
          <td><input type="radio" name="q20" id="q20a" value="A" /></td>
          <td><input type="radio" name="q20" id="q20b" value="B" /></td>
          <td><input type="radio" name="q20" id="q20c" value="C" /></td>
        </tr>
      </tbody>
    </table>
<div id="resetStatsBtn" style="display: none;">
  <button onclick="resetStats()">üßπ Reset Section 3 Stats</button>
</div>

    <div class="nav-row">
      <a href="index.html"><button>‚¨ÖÔ∏è Previous Part</button></a>
      <button onclick="checkAnswers()">‚úÖ Submit</button>
      <a href="part3.html"><button>‚û°Ô∏è Next Part</button></a>
      <div id="downloadPdfBtn" onclick="downloadPDF()">üìÑ Download PDF</div>
    </div>

    <div class="result" id="resultBox"></div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script>
    function playClip(startTime, duration = 1000) {
  const audio = document.getElementById("audio");
  audio.currentTime = startTime;
  audio.play();

  // Optional: stop after duration
  if (duration > 0) {
    const stopTime = startTime + duration;
    const stopPlayback = () => {
      if (audio.currentTime >= stopTime || audio.ended) {
        audio.pause();
        audio.removeEventListener("timeupdate", stopPlayback);
      }
    };
    audio.addEventListener("timeupdate", stopPlayback);
  }
}
const correctAnswers = {
  q11: "restaurant",
  q12: "homeless assistance ",
  q13: "ten years ",
  q14: "cuts",
  q15: "citizens",
  q16: "C",
  q17: "B",
  q18: "A",
  q19: "B",
  q20: "C"
};

function showFeedback(key, userInput, correctAnswer) {
  const inputEl = document.getElementById(key);
  const oldFeedback = document.getElementById(`${key}-feedback`);
  if (oldFeedback) oldFeedback.remove();

  const feedback = document.createElement("span");
  feedback.className = "feedback";
  feedback.id = `${key}-feedback`;

  if (userInput.trim().toLowerCase() === correctAnswer.toLowerCase()) {
    feedback.textContent = "‚úÖ Correct";
    feedback.style.color = "green";
    return { feedback, isCorrect: true };
  } else {
    feedback.textContent = `‚ùå Wrong ‚Äî Correct: ${correctAnswer}`;
    feedback.style.color = "red";
    return { feedback, isCorrect: false };
  }
}

function checkAnswers() {
  const submittedBefore = localStorage.getItem("p2_submitted");
  if (submittedBefore) {
    let attempts = +localStorage.getItem("p2_cheat") || 0;
    localStorage.setItem("p2_cheat", ++attempts);
    let shame = document.getElementById("cheat-warning");
    if (!shame) {
      shame = document.createElement("div");
      shame.id = "cheat-warning";
      shame.style.color = "red";
      shame.style.fontSize = "18px";
      shame.style.fontWeight = "bold";
      shame.style.textAlign = "center";
      shame.style.marginTop = "15px";
      document.getElementById("resultBox").after(shame);
    }
    shame.innerHTML = `üõë Stop cheating! You've tried ${attempts} times after submission! üò°`;
    return;
  }

  let correct = 0;
  const total = Object.keys(correctAnswers).length;

  for (let key in correctAnswers) {
    let userInput = "";

    if (["q16", "q17", "q18", "q19", "q20"].includes(key)) {
      const radios = document.getElementsByName(key);
      for (const radio of radios) {
        if (radio.checked) {
          userInput = radio.value;
          break;
        }
      }
    } else {
      const inputEl = document.getElementById(key);
      userInput = inputEl.value.trim();
    }

    const correctAnswer = correctAnswers[key];
    localStorage.setItem("p2_" + key, userInput);

    if (!["q16", "q17", "q18", "q19", "q20"].includes(key)) {
      const inputEl = document.getElementById(key);
      const { feedback, isCorrect } = showFeedback(key, userInput, correctAnswer);
      inputEl.parentNode.appendChild(feedback);
      if (isCorrect) correct++;
    } else {
      if (userInput.toLowerCase() === correctAnswer.toLowerCase()) correct++;
    }
  }

  const incorrect = total - correct;
  const resultText = `‚úÖ Correct: ${correct} üòä<br>‚ùå Wrong: ${incorrect} üò¢`;
  document.getElementById("resultBox").innerHTML = resultText;
  localStorage.setItem("p2_result", resultText);
  localStorage.setItem("p2_submitted", "true");

  document.getElementById("downloadPdfBtn").style.display = "block";
}

window.onload = () => {
  for (let key in correctAnswers) {
    const saved = localStorage.getItem("p2_" + key);
    if (saved) {
      if (["q16", "q17", "q18", "q19", "q20"].includes(key)) {
        const radios = document.getElementsByName(key);
        for (const radio of radios) {
          if (radio.value.toLowerCase() === saved.toLowerCase()) {
            radio.checked = true;
            break;
          }
        }
      } else {
        const inputEl = document.getElementById(key);
        inputEl.value = saved;
        const { feedback } = showFeedback(key, saved, correctAnswers[key]);
        inputEl.parentNode.appendChild(feedback);
      }
    }
  }

  const savedResult = localStorage.getItem("p2_result");
  if (savedResult) document.getElementById("resultBox").innerHTML = savedResult;

  if (localStorage.getItem("p2_submitted") === "true")
    document.getElementById("downloadPdfBtn").style.display = "block";

  const cheatCount = +localStorage.getItem("p2_cheat") || 0;
  if (cheatCount > 0) {
    const shame = document.createElement("div");
    shame.id = "cheat-warning";
    shame.style.color = "red";
    shame.style.fontSize = "18px";
    shame.style.fontWeight = "bold";
    shame.style.textAlign = "center";
    shame.style.marginTop = "15px";
    shame.innerHTML = `üõë You already submitted and tried to cheat ${cheatCount} time(s)!`;
    document.getElementById("resultBox").after(shame);
  }
};

function downloadPDF() {
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();
  doc.setFontSize(12);
  doc.text("Listening Practice ‚Äì (Section 2)", 10, 10);

  let y = 20;
  Object.entries(correctAnswers).forEach(([key, answer], i) => {
    const input = localStorage.getItem("p2_" + key) || "(empty)";
    doc.text(`${i + 1}. Your Answer: ${input} | Correct Answer: ${answer}`, 10, y);
    y += 10;
  });

  const result = localStorage.getItem("p2_result") || "";
  doc.text("Result:", 10, y + 10);
  doc.text(result.replace(/<br>/g, " "), 10, y + 20);
  doc.save("Section2_Answers.pdf");
}
function resetStats() {
  const password = prompt("Enter reset password:");

  if (password !== "listen123") {
    alert("‚ùå Incorrect password. Stats were not cleared.");
    return;
  }

  const keysToRemove = [];

  for (let i = 0; i < localStorage.length; i++) {
    const key = localStorage.key(i);
    if (key && key.startsWith("p2_")) {
      keysToRemove.push(key);
    }
  }

  if (keysToRemove.length === 0) {
    alert("‚ö†Ô∏è No Section 2 stats found to clear.");
    return;
  }

  keysToRemove.forEach(key => localStorage.removeItem(key));

  alert(`‚úÖ Section 2 stats cleared! (${keysToRemove.length} items)`);
  location.reload();
}

// ‚úÖ This must be outside the function
document.addEventListener("keydown", function (e) {
  if (e.ctrlKey && e.key.toLowerCase() === "i") {
    e.preventDefault(); // Optional: prevent browser default action for Ctrl+I (italic in some browsers)
    const btn = document.getElementById("resetStatsBtn");
    if (btn) {
      btn.style.display = "block";
      btn.scrollIntoView({ behavior: "smooth" });
    }
  }
});

</script>
</body>
</html>
